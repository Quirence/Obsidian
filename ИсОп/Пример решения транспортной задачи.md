$[1, 3, 4, 1]$
$[5, 2, 2, 7]$
$[4, 4, 2, 6]$
$[7, 2, 5, 3]$
$a_i^T = [100, 200, 400, 200]$
$b_j = [100, 200, 200, 300]$
Сначала проверяем условие баланса, т.е. $\sum a_i = \sum b_i$
Если условие баланса не выполняется, нужно либо добавить фиктивного потребителя, либо фиктивный склад.
В учебнике Зайченко решает матрицами, однако есть более удобные методы: табличные, в которые можно записать матрицы.
$\sum a_i = 100 + 200 + 400 + 200 = 900$
$\sum b_j = 100 + 200 + 200 + 300 = 800$ $=>$ условие баланса не выполняется
Так как в сумме заявок оказалось меньше, чем продуктов на складах, добавляем фиктивного потребителя.
Согласно алгоритму метода потенциалов, мы строим начальный опорный план, который также не должен образовывать цикл (В матрице ячейки не должны образовывать циклы)
Метод минимального элемента:
Перестраиваем матрицу с учетом фиктивного потребителя. Ищем опорный план X (допустимое базисное решение)
![[Pasted image 20241115155412.png]]
Дорога из $A_1$ в $B_1$ самая дешевая. Опустошаем склад $A_1$ и удовлетворяем заявку $B_1$ полностью.
![[Pasted image 20241115155711.png]]
Из оставшейся матрицы выбираем минимальный элемент. Это элемент $A_2, B_2$
Снова полностью удовлетворяем заявку.
Продолжаем алгоритм
![[Pasted image 20241115155910.png]]
Проверяем полученный опорный план на невырожденность:
Число занятых клеток должно быть $n + m - 1$ (По второму свойству Т-задачи, ранг матрицы ограничений равен $n+m-1$, но ранг есть число линейно-независимых векторов. Следовательно, и базисных клеток.)
$n + m - 1 = 5 + 4 - 1 = 8.$ Это не равно $6$.
Решение невырождено, и мы должны сделать 2 оставшиеся ячейки базисными, но без образования цикла.
Возьмем клетку $A_3, B_1$, и клетку $A_3, B_2$
![[Pasted image 20241115161156.png]]
(Фикт) обозначает, что мы перевозим бесконечно малую величину продукции.
Так как это ДБР (Опорный план), проверяем его на оптимальность:
Для этого составляем оценочную матрицу:
$C_l = ||C_{ij} - (V^{l - 1}_j - U^{l - 1}_{i})||_{m\times x}$
$C_{11} = V_1 - U_1 = 1$
$C_{22} = V_2 - U_2 = 2$
$C_{33} = V_3 - U_3 = 3$
$C_{34} = V_4 - U_3 = 6$
$C_{35} = V_5 - U_3 = 0$
$C_{31} = V_1 - U_3 = 4$
$C_{42} = V_2 - U_4 = 2$
$C_{44} = V_4 - U_4 = 3$
Количество переменных больше количества уравнений в системе (количество $V$ и $U$). Такая система имеет множество решений. Найдём одно из них.
$V_1 = 0, U_1 = -1, U_3 = -4, V_3 = -1, V_4 = 2, V_5 = -4, U_4 = -1, V_2 = 1, U_2 = -1$
$C_{11}^1 = C_{11} - (V_1 - U_1) = 1 - (0 - (-1)) = 0$
$C_{12}^1 = C_{12} - (V_2 - U_1) = 3 - (1 - (-1)) = 1$
$C_{13}^1 = C_{13} -  (V_3 - U_1) = 4 - (-1 - (-1)) = 4$
$C_{14}^1 = C_{14} - (V_4 - U_1) = 1 - (2 - (-1)) = -2$
$C_{15}^1 = C_{15} - (V_5 - U_1) = 0 - (-4 - (-1)) = 3$
---
$C_{21}^1 = C_{21} - (V_1 - U_2) = 5 - (0 - (-1)) = 4$
$C_{22}^1 = C_{22} - (V_2 - U_2) = 2 - (1 + (-1)) = 0$
$C_{23}^1 = C_{23} -  (V_3 - U_2) = 2 - (-1-(-1)) = 2$
$C_{24}^1 = C_{24} - (V_4 - U_2) = 4$
$C_{25}^1 = C_{25} - (V_5 - U_2) = 3$
---
$C_{31}^1 = C_{31} - (V_1 - U_3) = 0$
$C_{32}^1 = C_{32} - (V_2 - U_3) = 1$
$C_{33}^1 = C_{33} -  (V_3 - U_3) = 0$
$C_{34}^1 = C_{34} - (V_4 - U_3) = 0$
$C_{35}^1 = C_{35} - (V_5 - U_3) = 0$
---
$C_{41}^1 = C_{41} - (V_1 - U_4) = 6$
$C_{42}^1 = C_{42} - (V_2 - U_4) = 0$
$C_{43}^1 = C_{43} -  (V_3 - U_4) = 5$
$C_{44}^1 = C_{44} - (V_4 - U_4) = 0$
$C_{45}^1 = C_{45} - (V_5 - U_4) = -5$
---
$C_1$ = ![[Pasted image 20241115164613.png]]
Матрица $C_1$ содержит отрицательные элементы. Следовательно, план не оптимален.
$C_{14}$ - наибольший по модулю отрицательный элемент (Элемент, в направлении которого мы "ниже всего" спустимся)
С этим элементом и элементами базиса составим цикл:
![[Pasted image 20241115165242.png]]
(Базисные элементы в углах. Небазисному поставили знак $+$, далее меняем)
Находим минимальное значение среди отрицательных. Это значение мы будем перебрасывать.
Добавляем +100 к каждому $(+)$
Отнимаем 100 от каждого $(-)$
![[Pasted image 20241115165504.png]]
Проверим новый план на оптимальность
Для всех занятых клеток (где x $\neq$ 0), строим систему уравнений
$C_{11} = V_1 - U_1 = 1$
$C_{14} = V_4 - U_1 = 1$
$C_{22} = V_2 - U_2 = 2$
$C_{31} = V_1 - U_3 = 4$
$C_{33} = V_3 - U_3 = 3$
$C_{35} = V_5 - U_3 = 0$
$C_{42} = V_2 - U_4 = 2$
$C_{44} = V_4 - U_4 = 3$
Найдем решение данной системы. Пусть $U_1 = 0$
Тогда $V_1 = 1, V_4 = 1, U_3 = -3, V_3 = 0, U_4 = -2, V_2 = 0, U_2 = -2, V_5 = -3$Находим C в этой итерации.
$C_{11}^2 = C_{11} - (V_1 - U_1) = 0$
$C_{12}^2 = C_{12} - (V_2 - U_1) = 3$
$C_{13}^2 = C_{13} -  (V_3 - U_1) = 4$
$C_{14}^2 = C_{14} - (V_4 - U_1) = 0$
$C_{15}^2 = C_{15} - (V_5 - U_1) = 3$
---
$C_{21}^2 = C_{21} - (V_1 - U_2) = 2$
$C_{22}^2 = C_{22} - (V_2 - U_2) = 0$
$C_{23}^2 = C_{23} - (V_3 - U_2) = 0$
$C_{24}^2 = C_{24} - (V_4 - U_2) = 4$
$C_{25}^2 = C_{25} - (V_5 - U_2) = 1$
---
$C_{31}^2 = C_{31} - (V_1 - U_3) = 0$
$C_{32}^2 = C_{32} - (V_2 - U_3) = 1$
$C_{33}^2 = C_{33} - (V_3 - U_3) = 0$
$C_{34}^2 = C_{34} - (V_4 - U_3) = 2$
$C_{35}^2 = C_{35} - (V_5 - U_3) = 0$
---
$C_{41}^2 = C_{41} - (V_1 - U_4) = 4$
$C_{42}^2 = C_{42} - (V_2 - U_4) = 0$
$C_{43}^2 = C_{43} - (V_3 - U_4) = 3$
$C_{44}^2 = C_{44} - (V_4 - U_4) = 0$
$C_{45}^2 = C_{45} - (V_5 - U_4) = 1$
Матрица $$C_2 = \begin{pmatrix}
 0&  3&  4&  0&  3\\
 2&  0&  0&  4&  1\\
 0&  1&  0&  2&  0\\
 4&  0&  3&  0&  1\\
\end{pmatrix}$$содержит все оптимальные элементы, следовательно план оптимален.
$A_1 \rightarrow B_4 (100)$
$A_2 \rightarrow B_2 (200)$
$A_3 \rightarrow B_1 (100)$
$A_3 \rightarrow B_3 (200)$ (на складе еще останется 100)
$A_4 \rightarrow B_4 (200)$
При защите лабораторной требуется поставить задачу, определить опорный план, объяснить что такое базисное решение, 4 теоремы транспортной задачи (метод потенциалов), 2 свойства обосновывающие что количество занятых клеток $n + m - 1$, условие баланса, объяснить что клетки не должны образовывать цикл (по теореме), формулу объяснить, обосновать теоремы 1 и 2 по теории двойственности (на 5.), 3 4 обосновать исходя из геометрической интерпретации сложения векторов (замкнутый цикл = сумма векторов)